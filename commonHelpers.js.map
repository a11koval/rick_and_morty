{"version":3,"file":"commonHelpers.js","sources":["../src/js/devider.js","../src/js/search-section.js"],"sourcesContent":["const chips = [\n  \"Animated\", \"the adventures\", \"Justin Roiland\", \"superpower\",\n  \"creative\", \"amazing\", \"Sitcom\", \"comics\",\n  \"follows\", \"characters\", \"whoa\", \"Rick and Morty\"\n];\n\nconst divider = document.getElementById(\"divider\");\n\nchips.forEach((text, i) => {\n  const span = document.createElement(\"span\");\n  span.textContent = text;\n  span.className = `chip ${i % 2 === 0 ? \"light\" : \"dark\"}`;\n\n  // випадковий нахил (деякі догори дриґом)\n  const flipped = Math.random() > 0.6; // ~40% перевернуті\n  const angle = (flipped ? 180 : 0) + (Math.random() * 30 - 15);\n  span.style.setProperty(\"--angle\", `${angle}deg`);\n\n  // різна затримка для більш природного руху\n  span.style.animationDelay = `${Math.random() * 2}s`;\n\n  divider.appendChild(span);\n});","const API_URL = \"https://rickandmortyapi.com/api/episode\";\nconst episodesContainer = document.getElementById(\"episodesContainer\");\nconst loadMoreBtn = document.getElementById(\"loadMoreBtn\");\nconst selectSeason = document.getElementById(\"selectSeason\");\nconst searchInput = document.getElementById(\"searchName\");\nconst searchBtn = document.getElementById(\"searchBtn\");\n\nlet allEpisodes = [];\nlet filteredEpisodes = [];\nlet visibleCount = 20;\n\n\nasync function fetchEpisodes() {\n  try {\n    let nextPage = API_URL;\n\n    while (nextPage) {\n      const res = await fetch(nextPage);\n      const data = await res.json();\n      allEpisodes.push(...data.results);\n      nextPage = data.info.next;\n    }\n\n\n    allEpisodes = allEpisodes.filter(ep => {\n      const seasonCode = ep.episode.slice(0, 3);\n      return [\"S01\", \"S02\", \"S03\", \"S04\", \"S05\"].includes(seasonCode);\n    });\n\n    filteredEpisodes = allEpisodes;\n    renderEpisodes();\n  } catch (error) {\n    console.error(\"Error fetching episodes:\", error);\n    showPlaceholder(true);\n  }\n}\n\n\nfunction renderEpisodes() {\n  episodesContainer.innerHTML = \"\";\n\n  const visibleEpisodes = filteredEpisodes.slice(0, visibleCount);\n\n  if (visibleEpisodes.length === 0) {\n    showPlaceholder(true);\n    return;\n  }\n\n  showPlaceholder(false);\n\n  visibleEpisodes.forEach((ep) => {\n    const card = document.createElement(\"div\");\n    card.classList.add(\"episode-card\");\n\n    card.setAttribute('data-episode-id', ep.id);\n\n    card.innerHTML = `\n      <img src=\"images/season-corect.png\" alt=\"${ep.name}\" onerror=\"this.src='img/portal.png'\">\n      <div class=\"episode-info\">\n        <h3>${ep.name}</h3>\n        <p>Season: ${ep.episode.slice(1, 3)}</p>\n        <p>Air date: ${ep.air_date}</p>\n      </div>\n    `;\n    episodesContainer.appendChild(card);\n  });\n\n  loadMoreBtn.style.display = filteredEpisodes.length > visibleCount ? \"block\" : \"none\";\n}\n\n\nfunction applyFilters() {\n  const season = selectSeason.value;\n  const searchValue = searchInput.value.trim().toLowerCase();\n\n  filteredEpisodes = allEpisodes.filter((ep) => {\n    const matchSeason = season === \"all\" || ep.episode.startsWith(season);\n    const matchName = ep.name.toLowerCase().includes(searchValue);\n    return matchSeason && matchName;\n  });\n\n  visibleCount = 20;\n  renderEpisodes();\n}\n\n\nfunction showPlaceholder(show) {\n  if (show) {\n    episodesContainer.innerHTML = `\n      <div class=\"placeholder\">\n        <img src=\"images/portal.png\" alt=\"Portal\" />\n        <p>Oops! Try looking for something else...</p>\n      </div>\n    `;\n    loadMoreBtn.style.display = \"none\";\n  }\n}\n\n\nloadMoreBtn.addEventListener(\"click\", () => {\n  visibleCount += 20;\n  renderEpisodes();\n});\n\n\nselectSeason.addEventListener(\"change\", applyFilters);\nsearchBtn.addEventListener(\"click\", applyFilters);\nsearchInput.addEventListener(\"keydown\", (e) => {\n  if (e.key === \"Enter\") applyFilters();\n});\n\n\nfetchEpisodes();\n/* ===========================\n   Modal + Delegated Clicks\n   =========================== */\n\n(function () {\n  // Переконаємось, що елементи існують\n  if (!episodesContainer) {\n    console.error(\"episodesContainer не знайдено — перевір, що id='episodesContainer' в HTML.\");\n    return;\n  }\n\n  // Створюємо/відкриваємо модалку\n  async function openEpisodeModal(episode) {\n    try {\n      // Видаляємо стару модалку, якщо є\n      const old = document.querySelector(\".episode-modal\");\n      if (old) old.remove();\n\n      // Контейнер модалки\n      const modal = document.createElement(\"div\");\n      modal.className = \"episode-modal\";\n\n      modal.innerHTML = `\n        <div class=\"modal-season-backdrop\"></div>\n        <div class=\"modal-window\" role=\"dialog\" aria-modal=\"true\">\n          <button class=\"modal-close\" aria-label=\"Close\">&times;</button>\n          <h2 class=\"modal-title\">${escapeHtml(episode.name)}</h2>\n          <div class=\"modal-details\">\n            <p><strong>ID:</strong> ${episode.id}</p>\n            <p><strong>Air date:</strong> ${escapeHtml(episode.air_date)}</p>\n            <p><strong>Code:</strong> ${escapeHtml(episode.episode)}</p>\n          </div>\n          <h3>Characters</h3>\n          <div class=\"modal-characters\"><p>Loading characters...</p></div>\n        </div>\n      `;\n\n      document.body.appendChild(modal);\n      // фокус на модалку\n      modal.querySelector(\".modal-window\").focus?.();\n\n      // Закриття\n      const removeModal = () => modal.remove();\n      modal.querySelector(\".modal-close\").addEventListener(\"click\", removeModal);\n      modal.querySelector(\".modal-season-backdrop\").addEventListener(\"click\", removeModal);\n      window.addEventListener(\n        \"keydown\",\n        function escHandler(e) {\n          if (e.key === \"Escape\") {\n            removeModal();\n            window.removeEventListener(\"keydown\", escHandler);\n          }\n        }\n      );\n\n      // Завантажуємо персонажів (перші 6)\n      const charactersBox = modal.querySelector(\".modal-characters\");\n      const charUrls = episode.characters.slice(0, 6);\n      if (charUrls.length === 0) {\n        charactersBox.innerHTML = \"<p>No characters</p>\";\n        return;\n      }\n\n      try {\n        const chars = await Promise.all(\n          charUrls.map((url) =>\n            fetch(url).then((res) => {\n              if (!res.ok) throw new Error(\"character fetch failed: \" + res.status);\n              return res.json();\n            })\n          )\n        );\n        charactersBox.innerHTML = chars\n          .map(\n            (c) => `\n            <div class=\"char\">\n              <img src=\"${escapeAttr(c.image)}\" alt=\"${escapeAttr(c.name)}\">\n              <div class=\"char-name\">${escapeHtml(c.name)}</div>\n            </div>`\n          )\n          .join(\"\");\n      } catch (err) {\n        console.error(\"Error loading characters:\", err);\n        charactersBox.innerHTML = \"<p>Error loading characters</p>\";\n      }\n    } catch (err) {\n      console.error(\"openEpisodeModal error:\", err);\n    }\n  }\n\n  // Функція-утиліта для безпечного вставляння тексту\n  function escapeHtml(str) {\n    if (typeof str !== \"string\") return str;\n    return str\n      .replace(/&/g, \"&amp;\")\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\")\n      .replace(/\"/g, \"&quot;\")\n      .replace(/'/g, \"&#039;\");\n  }\n  function escapeAttr(s) {\n    return escapeHtml(s).replace(/\"/g, \"&quot;\");\n  }\n\n  // Делегуємо клік на контейнері — коли створюєш картки, вони повинні мати data-attribute with index or id\n  // Ми знайдемо епізод за ім'ям/ID у filteredEpisodes (змінна з твого коду).\n  episodesContainer.addEventListener(\"click\", function (e) {\n    // шукаємо батьківський .episode-card\n    const card = e.target.closest(\".episode-card\");\n    if (!card) return;\n\n    // Зчитуємо унікальні дані з DOM; краще покласти data-episode-id при рендері\n    const epName = card.querySelector(\".episode-info h3\")?.textContent?.trim();\n    const epCode = card.querySelector(\".episode-info p\")?.textContent?.trim();\n\n    // Спосіб 1: якщо в карці помістили data-id при рендері — шукай по id\n    let epId = card.getAttribute(\"data-episode-id\");\n    let episodeObj;\n\n    if (epId && window.allEpisodes) {\n      episodeObj = window.allEpisodes.find((x) => String(x.id) === String(epId));\n    } else if (epName && window.filteredEpisodes) {\n      // fallback - шукаємо по імені (менш надійно, але працює)\n      episodeObj = window.filteredEpisodes.find((x) => x.name === epName);\n    }\n\n    if (!episodeObj) {\n      console.warn(\"Episode object not found for clicked card. Consider adding data-episode-id to cards.\");\n      // Показати швидке повідомлення в консолі\n      return;\n    }\n\n    openEpisodeModal(episodeObj);\n  });\n\n  // Рекомендація: коли рендериш картки, додавай data-episode-id — тоді делегування працює стабільно.\n  // Тут приклад, як змінити рендерEpisodes (якщо хочеш мінімально змінити):\n  // в renderEpisodes() при створенні card:\n  // card.setAttribute('data-episode-id', ep.id);\n\n  // ---------- Для безпеки зробимо allEpisodes та filteredEpisodes глобально доступними (тільки якщо вони існують) ----------\n  if (!window.allEpisodes && typeof allEpisodes !== \"undefined\") window.allEpisodes = allEpisodes;\n  if (!window.filteredEpisodes && typeof filteredEpisodes !== \"undefined\") window.filteredEpisodes = filteredEpisodes;\n})();"],"names":["chips","divider","text","i","span","angle","API_URL","episodesContainer","loadMoreBtn","selectSeason","searchInput","searchBtn","allEpisodes","filteredEpisodes","visibleCount","fetchEpisodes","nextPage","data","ep","seasonCode","renderEpisodes","error","showPlaceholder","visibleEpisodes","card","applyFilters","season","searchValue","matchSeason","matchName","show","e","openEpisodeModal","episode","old","modal","escapeHtml","_b","_a","removeModal","escHandler","charactersBox","charUrls","chars","url","res","c","escapeAttr","err","str","s","epName","_d","_c","epId","episodeObj","x"],"mappings":"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"}